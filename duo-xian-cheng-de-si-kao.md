# 多线程的思考

## 什么情况下才会出现多线程并发需要同步的需求？



今天做了一点多线程的思考，不知道对与不对，仅供参考：

1. 在操作系统中，进程是资源的分配单位，线程是任务的调度单位，同一进程下的多线程共享进程的内存资源；
2. 如果没有线程或一个进程只有一个线程，应该就不会有线程级别并发/并行的同步问题了；
3. 为了提高任务执行效率，进程中采用多线程的任务处理式，但它们的内存资源是共享的，在不采取任务手段的话，内存中数据就有可能出现不一致的情况；
4. 于是并发问题出现的原因：
   1. 内存共享；
   2. 多线程非原子性使用；
   3. 目标：数据一致性。
5. 因为线程调度器不控制资源，不管理内存，因此不能做到线程无感知情况下的内存限制，只有通过线程程序中的机制来处理多线程并发/并行问题了。
6. 无状态线程可以随意运行，不用考虑并发问题；
7. 凡是出现多线程问题的，都是需要保持数据状态的（数据保存到内存中），以免出现数据不一致；
8. 解决多线程问题，关键就在于有状态数据操作的原子性。
9. 所以所有的多线程处理机制都是以这个为目标的？对吗？
10. 如果让线程无感知使用内存，在内存级别保障数据的一致性，能做到吗？
    1. 不能。
    2. 内存共享；
    3. 非原子操作。
    4. 
11. 下一步就要看线程级别如何做到有状态数据的原子性？

## Have you had a chance to answer the previous question?

Yes, after a few months we finally found the answer. Sadly, Mike is on vacations right now so I'm afraid we are not able to provide the answer at this point.



